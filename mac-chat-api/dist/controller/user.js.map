{"version":3,"sources":["../../src/controller/user.js"],"names":["config","db","api","post","req","res","newUser","name","body","email","avatarName","avatarColor","save","err","status","json","message","get","find","users","findById","params","id","user","put","findOne","exec","userData","delete","remove","_id"],"mappings":"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","file":"user.js","sourcesContent":["import mongoose from 'mongoose';\nimport { Router } from 'express';\nimport bodyParser from 'body-parser';\nimport User from '../model/user';\n\nimport { authenticate } from '../middleware/authMiddleware';\n\nexport default({ config, db }) => {\n  let api = Router();\n\n  // '/v1/user/add' - Create\n  api.post('/add', authenticate, (req, res) => {\n    let newUser = new User();\n    newUser.name = req.body.name;\n    newUser.email = req.body.email;\n    newUser.avatarName = req.body.avatarName;\n    newUser.avatarColor = req.body.avatarColor;\n\n    newUser.save(err => {\n      if (err) {\n        res.status(500).json({ message: err });\n      }\n      res.status(200).json(newUser);\n    });\n  });\n\n  // '/v1/user/' - Read\n  api.get('/', authenticate, (req, res) => {\n    User.find({}, (err, users) => {\n      if (err) {\n        res.status(500).json({ message: err });\n      }\n      res.status(200).json(users);\n    });\n  });\n\n  // '/v1/user/:id' - Read 1\n  api.get('/:id', authenticate, (req, res) => {\n    User.findById(req.params.id, (err, user) => {\n      if (err) {\n        res.status(500).json({ message: err });\n      }\n      res.status(200).json(user);\n    });\n  });\n\n  // '/v1/user/:id' - Update\n  api.put('/:id', authenticate, (req, res) => {\n    User.findById(req.params.id, (err, user) => {\n      if (err) {\n        res.status(500).json({ message: err });\n      }\n      user.name = req.body.name;\n      user.email = req.body.email;\n      user.avatarName = req.body.avatarName;\n      user.avatarColor = req.body.avatarColor;\n      user.save(err => {\n        if (err) {\n          res.status(500).json({ message: err });\n        }\n        res.status(200).json({ message: 'User info updated' });\n      });\n    });\n  });\n\n  // 'v1/user/byEmail/:email'\n  api.get('/byEmail/:email', authenticate, (req, res) => {\n    User\n      .findOne({ 'email': req.params.email })\n      .exec((err, userData) => {\n        if (err) {\n          res.status(500).json({ message: err });\n        }\n        res.status(200).json(userData);\n      });\n  });\n\n  // '/vq/user/:id' -Delete\n  api.delete('/:id', authenticate, (req, res) => {\n    User.remove({\n      _id: req.params.id\n    }, (err, user) => {\n      if (err) {\n        res.status(500).json({ message: err });\n      }\n      res.status(200).json({ message: 'User Successfully Removed'});\n    });\n  });\n\n  // '/v1/user/' - Delete all\n  api.delete('/', authenticate, (req, res) => {\n    User.find({}, (err, users) => {\n      if (err) {\n        res.status(500).json({ message: err });\n      }\n      res.status(200).json({ message: 'Users All Removed'});\n    });\n  });\n\n  return api;\n}\n"]}